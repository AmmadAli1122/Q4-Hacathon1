"use strict";(globalThis.webpackChunkphysical_ai_docs=globalThis.webpackChunkphysical_ai_docs||[]).push([[961],{715(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"physical-ai/module-1-ros2/chapter-2-communication-motion","title":"Chapter 2 - Communication in Motion","description":"Introduction","source":"@site/docs/physical-ai/module-1-ros2/chapter-2-communication-motion.md","sourceDirName":"physical-ai/module-1-ros2","slug":"/physical-ai/module-1-ros2/chapter-2-communication-motion","permalink":"/docs/physical-ai/module-1-ros2/chapter-2-communication-motion","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/physical-ai/module-1-ros2/chapter-2-communication-motion.md","tags":[],"version":"current","frontMatter":{"title":"Chapter 2 - Communication in Motion","sidebar_label":"Chapter 2: Communication in Motion"},"sidebar":"physicalAISidebar","previous":{"title":"Chapter 1: The Robotic Nervous System","permalink":"/docs/physical-ai/module-1-ros2/chapter-1-robotic-nervous-system"},"next":{"title":"Chapter 3: From Code to Body","permalink":"/docs/physical-ai/module-1-ros2/chapter-3-code-to-body"}}');var r=i(4848),t=i(8453);const o={title:"Chapter 2 - Communication in Motion",sidebar_label:"Chapter 2: Communication in Motion"},a="Chapter 2: Communication in Motion \u2014 Nodes, Topics, and Services",l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"ROS 2 Nodes: Autonomous Computational Units",id:"ros-2-nodes-autonomous-computational-units",level:2},{value:"Creating a Node",id:"creating-a-node",level:3},{value:"Topics: Continuous Data Streams",id:"topics-continuous-data-streams",level:2},{value:"How Topics Work",id:"how-topics-work",level:3},{value:"Example: Publisher and Subscriber",id:"example-publisher-and-subscriber",level:3},{value:"Services: Request-Response Interactions",id:"services-request-response-interactions",level:2},{value:"How Services Work",id:"how-services-work",level:3},{value:"Example: Service Server and Client",id:"example-service-server-and-client",level:3},{value:"Design Patterns for Scalable Robot Communication",id:"design-patterns-for-scalable-robot-communication",level:2},{value:"Publisher-Subscriber Pattern",id:"publisher-subscriber-pattern",level:3},{value:"Client-Server Pattern (Services)",id:"client-server-pattern-services",level:3},{value:"Action Pattern",id:"action-pattern",level:3},{value:"Parameter Server Pattern",id:"parameter-server-pattern",level:3},{value:"When to Use Topics vs Services",id:"when-to-use-topics-vs-services",level:2},{value:"Use Topics When:",id:"use-topics-when",level:3},{value:"Use Services When:",id:"use-services-when",level:3},{value:"Practical Considerations",id:"practical-considerations",level:2},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:3},{value:"Message Types",id:"message-types",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-2-communication-in-motion--nodes-topics-and-services",children:"Chapter 2: Communication in Motion \u2014 Nodes, Topics, and Services"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"In the previous chapter, we explored ROS 2 as the robotic nervous system and learned about its distributed architecture. Now, we'll dive deeper into the specific communication mechanisms that make this distributed system work: nodes, topics, and services. Understanding these communication patterns is essential for designing effective robotic systems."}),"\n",(0,r.jsx)(n.h2,{id:"ros-2-nodes-autonomous-computational-units",children:"ROS 2 Nodes: Autonomous Computational Units"}),"\n",(0,r.jsx)(n.p,{children:"Nodes are the fundamental building blocks of any ROS 2 system. Each node is an autonomous computational unit that performs a specific task within the robotic system. A node can be thought of as a process that implements part of the robot's functionality."}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,r.jsxs)(n.p,{children:["In Python, nodes are created by extending the ",(0,r.jsx)(n.code,{children:"Node"})," class from ",(0,r.jsx)(n.code,{children:"rclpy"}),". Here's a basic example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MinimalNode(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        # Node initialization code here\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_node = MinimalNode()\n\n    rclpy.spin(minimal_node)\n\n    minimal_node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.p,{children:"Nodes are autonomous, meaning they can run independently and make their own decisions. They communicate with other nodes through topics, services, and other mechanisms we'll explore."}),"\n",(0,r.jsx)(n.h2,{id:"topics-continuous-data-streams",children:"Topics: Continuous Data Streams"}),"\n",(0,r.jsx)(n.p,{children:"Topics are the primary mechanism for continuous data streams in ROS 2. They use a publish-subscribe pattern where nodes can publish data to a topic and other nodes can subscribe to that topic to receive the data."}),"\n",(0,r.jsx)(n.h3,{id:"how-topics-work",children:"How Topics Work"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publisher"}),": A node that sends data to a topic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscriber"}),": A node that receives data from a topic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic"}),": The named channel through which data flows"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Topics are ideal for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sensor data (camera images, LIDAR scans, IMU readings)"}),"\n",(0,r.jsx)(n.li,{children:"Robot state information (position, velocity)"}),"\n",(0,r.jsx)(n.li,{children:"Continuous control commands"}),"\n",(0,r.jsx)(n.li,{children:"System status updates"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-publisher-and-subscriber",children:"Example: Publisher and Subscriber"}),"\n",(0,r.jsx)(n.p,{children:"Here's a simple example of a publisher node:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.p,{children:"And here's a corresponding subscriber:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"services-request-response-interactions",children:"Services: Request-Response Interactions"}),"\n",(0,r.jsx)(n.p,{children:"While topics are excellent for continuous data streams, sometimes you need request-response interactions. This is where services come in. Services allow a node to send a request and receive a response, similar to a function call across the network."}),"\n",(0,r.jsx)(n.h3,{id:"how-services-work",children:"How Services Work"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Client"}),": A node that sends a request to a service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Server"}),": A node that receives the request, processes it, and sends back a response"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service"}),": The named endpoint that handles the request-response interaction"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Services are ideal for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Actions that need confirmation (moving to a specific position)"}),"\n",(0,r.jsx)(n.li,{children:"Querying robot state (current battery level)"}),"\n",(0,r.jsx)(n.li,{children:"Triggering specific behaviors (starting navigation)"}),"\n",(0,r.jsx)(n.li,{children:"Configuration changes"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-service-server-and-client",children:"Example: Service Server and Client"}),"\n",(0,r.jsxs)(n.p,{children:["First, let's define a service request. You would typically create a ",(0,r.jsx)(n.code,{children:".srv"})," file, but here's a conceptual example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Service server example\nimport rclpy\nfrom rclpy.node import Node\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        # Define service here (would use custom service type in practice)\n        # self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Returning: {response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_service = MinimalService()\n    rclpy.spin(minimal_service)\n    minimal_service.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"design-patterns-for-scalable-robot-communication",children:"Design Patterns for Scalable Robot Communication"}),"\n",(0,r.jsx)(n.h3,{id:"publisher-subscriber-pattern",children:"Publisher-Subscriber Pattern"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Decouples publishers from subscribers"}),"\n",(0,r.jsx)(n.li,{children:"Enables one-to-many communication"}),"\n",(0,r.jsx)(n.li,{children:"Provides loose coupling between nodes"}),"\n",(0,r.jsx)(n.li,{children:"Supports different update frequencies"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"client-server-pattern-services",children:"Client-Server Pattern (Services)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Provides synchronous request-response"}),"\n",(0,r.jsx)(n.li,{children:"Ensures request processing"}),"\n",(0,r.jsx)(n.li,{children:"Good for actions requiring confirmation"}),"\n",(0,r.jsx)(n.li,{children:"Enables remote procedure calls"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"action-pattern",children:"Action Pattern"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For long-running tasks with feedback"}),"\n",(0,r.jsx)(n.li,{children:"Provides goal, feedback, and result"}),"\n",(0,r.jsx)(n.li,{children:"Allows for preemption and cancellation"}),"\n",(0,r.jsx)(n.li,{children:"Suitable for navigation, manipulation tasks"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"parameter-server-pattern",children:"Parameter Server Pattern"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralized configuration management"}),"\n",(0,r.jsx)(n.li,{children:"Dynamic parameter updates"}),"\n",(0,r.jsx)(n.li,{children:"Type-safe parameter access"}),"\n",(0,r.jsx)(n.li,{children:"Node-specific and global parameters"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use-topics-vs-services",children:"When to Use Topics vs Services"}),"\n",(0,r.jsx)(n.h3,{id:"use-topics-when",children:"Use Topics When:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You need continuous data streams"}),"\n",(0,r.jsx)(n.li,{children:"Multiple subscribers need the same data"}),"\n",(0,r.jsx)(n.li,{children:"You don't need confirmation of receipt"}),"\n",(0,r.jsx)(n.li,{children:"Data is time-sensitive (sensors, state)"}),"\n",(0,r.jsx)(n.li,{children:"Communication is asynchronous"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"use-services-when",children:"Use Services When:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You need request-response interaction"}),"\n",(0,r.jsx)(n.li,{children:"You require confirmation of action"}),"\n",(0,r.jsx)(n.li,{children:"The operation has a clear start and end"}),"\n",(0,r.jsx)(n.li,{children:"You need to query information"}),"\n",(0,r.jsx)(n.li,{children:"Synchronous communication is acceptable"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"practical-considerations",children:"Practical Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 provides QoS settings that allow you to tune communication behavior:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reliability (reliable vs. best-effort)"}),"\n",(0,r.jsx)(n.li,{children:"Durability (transient-local vs. volatile)"}),"\n",(0,r.jsx)(n.li,{children:"History (keep-all vs. keep-last)"}),"\n",(0,r.jsx)(n.li,{children:"Rate limiting and buffering"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"message-types",children:"Message Types"}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 comes with standard message types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"std_msgs"}),": Basic data types (String, Int32, Float64, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sensor_msgs"}),": Sensor data (Image, LaserScan, Imu, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"geometry_msgs"}),": Spatial information (Point, Pose, Twist, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nav_msgs"}),": Navigation-related messages"]}),"\n",(0,r.jsx)(n.li,{children:"Custom message types for specific applications"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Communication patterns in ROS 2 are fundamental to creating effective robotic systems. Topics provide continuous data streams ideal for sensor data and state information, while services offer request-response interactions for actions requiring confirmation. Understanding when to use each pattern is crucial for designing scalable and maintainable robotic systems."}),"\n",(0,r.jsx)(n.p,{children:"The design patterns we've covered provide a foundation for building complex robotic applications with proper separation of concerns and appropriate communication mechanisms."}),"\n",(0,r.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Design a communication pattern for a robot with a camera, where you want to save images when a specific object is detected. Would you use topics, services, or both? Explain your reasoning."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a simple publisher that publishes the current time every second, and a subscriber that logs the time difference between consecutive messages."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Identify three scenarios in a mobile robot application where you would use services instead of topics, and explain why."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>o,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);